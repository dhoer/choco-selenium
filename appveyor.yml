version: '{build}-{branch}'

install:
  - set PATH=C:\Ruby23\bin;%PATH%
  - bundle install
  - choco install chocolatey-core.extension
  - choco install -y nssm --pre
  - choco pack
  - choco install -y selenium --params "'/role:hub /service /autostart /port:4446'" -d -s .
  - choco install -y googlechrome selenium-chrome-driver
  - choco install -y selenium --params "'/role:node /hub:http://localhost:4446 /port:5557 /autostart'" -d -s . --force
  - ps: Start-Process C:\tools\selenium\node.cmd -PassThru

build: off

before_test:
  - ruby -v
  - gem -v
  - bundle -v

test_script:
  - bundle exec rake

deploy:
  provider: NuGet
  server: https://push.chocolatey.org/
  api_key:
    secure: Se/0Rf8flvUC1PKr3UZc8zCDcUZQr2RSY6zwkzACgOExP3pFC8NRyk6XoZUZnX+t
  skip_symbols: true
  symbol_server:           # remove to push symbols to SymbolSource.org
  artifact: /.*\.nupkg/
